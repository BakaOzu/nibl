// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('niblApp').factory('timer', function($interval, $modal) {
    var User, timer;
    User = {
      pomodoroInterval: 1500000
    };
    return timer = {
      current: {},
      task: {},
      remainingTime: User.pomodoroInterval,
      _countdown: function(timeRemains) {
        var endMoment, that;
        endMoment = moment() + timeRemains;
        that = this;
        return this.current = $interval(function() {
          that.remainingTime = endMoment - moment();
          console.log(that.remainingTime);
          if (that.remainingTime <= 0) {
            return that.stop();
          }
        }, 1000);
      },
      startCountdown: function(task) {
        this.task = task;
        return this._countdown(User.pomodoroInterval);
      },
      stop: function() {
        $interval.cancel(this.current);
        return this.current = void 0;
      },
      resume: function() {
        return this._countdown(this.remainingTime);
      },
      reset: function() {
        this.stop();
        return this.remainingTime = User.pomodoroInterval;
      },
      fullReset: function() {
        var task;
        this.reset();
        return task = {};
      }
    };
  });

}).call(this);
